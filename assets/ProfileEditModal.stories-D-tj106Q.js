import{j as e}from"./jsx-runtime-B0kvwH3U.js";import{r as i}from"./iframe-D98bH3IO.js";import{n as E}from"./image-DgKn6paS.js";import{c as C}from"./cn-DWDuF9m2.js";import{P}from"./ProfileImageChangeInput-CPWCsDc3.js";import{I}from"./Input-lgNxdI6B.js";import{T as _}from"./TextBox-B9JUG0cc.js";import{D as U}from"./DropDown-VXrHGXfM.js";import{B as D}from"./Button-8Ah0JUUc.js";import{a as T}from"./fetcher-BJpVLrhT.js";import"./preload-helper-B4AOKawx.js";import"./use-merged-ref-B7D4hTCK.js";import"./TextField-DJuBiMC9.js";import"./auth.store-TBYXye_t.js";var F={};const q=F.NEXT_PUBLIC_API_URL;async function B(n){const s=new FormData;s.append("image",n);try{const a=await fetch(`${q}/api/image`,{method:"POST",body:s});if(!a.ok){let o=`업로드 실패 (code ${a.status})`;try{const r=await a.json();o=r.detail||r.message||o}catch{const r=await a.text();r&&(o=r)}throw new Error(o)}return(await a.json()).imageUrl}catch(a){throw console.error("이미지 업로드 중 오류 발생:",a),a instanceof Error?new Error(a.message):new Error("알 수 없는 오류가 발생했습니다.")}}const u=({imageUrl:n,nickname:s,introduction:a,category:g,className:o,onClose:r,onSave:y,onError:x})=>{const[f,j]=i.useState(null),[c,v]=i.useState(s),[d,k]=i.useState(a??""),[p,b]=i.useState(g??""),[w,h]=i.useState(!1),N=["전자제품/가전제품","식료품","의류/패션","스포츠/레저","뷰티/화장품","게임","도서/음반/문구","티켓/쿠폰","리빙/가구/생활","반려동물/취미"].map(t=>({label:t,value:t})),S=async()=>{try{h(!0);let t=n;f&&(t=await B(f));const l={};c.trim()&&(l.nickname=c),d.trim()&&(l.introduction=d),t&&(l.imageUrl=t),p.trim()&&(l.category=p),await T("/api/users/me",{method:"PATCH",body:JSON.stringify(l)}),y?.()}catch(t){t instanceof Error?(console.error("프로필 수정 실패:",t),x?.(t)):x?.(new Error(String(t)))}finally{h(!1)}};return e.jsxs("div",{className:C("bg-black-900 relative flex flex-col rounded-lg","w-[300px] gap-[15px] p-5","md:w-[520px] md:gap-[20px] md:p-10","xl:w-[620px] xl:gap-[30px] xl:p-10",o),children:[e.jsx("button",{type:"button",onClick:r,className:"absolute top-3 right-3",children:e.jsx(E,{src:"icons/delete.svg",alt:"닫기",width:24,height:24})}),e.jsx("h2",{className:"mb-6 text-lg font-semibold text-white",children:"프로필 수정"}),e.jsxs("div",{className:"flex w-full flex-col items-start gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"프로필 이미지"}),e.jsx(P,{imgUrl:n,onChange:j})]}),e.jsxs("div",{className:"flex flex-col items-start gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"닉네임"}),e.jsx(I,{value:c,onChange:t=>v(t.target.value),className:"w-[260px] xl:w-[540px]"})]}),e.jsxs("div",{className:"flex w-full flex-col items-start gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"자기소개"}),e.jsx(_,{value:d,placeholder:"자기소개를 입력하세요...",onChange:t=>k(t.target.value),className:"w-[260px] md:w-[440px] xl:w-[540px]"})]}),e.jsxs("div",{className:"flex w-full flex-col items-start gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-white",children:"카테고리"}),e.jsx(U,{value:p,onChange:t=>b(t),options:N,className:"w-[260px] md:w-[440px] xl:w-[540px]"})]}),e.jsx("div",{className:"mt-auto flex w-full",children:e.jsx(D,{className:"mt-3 md:w-[440px]",variant:"primary",disabled:w,onClick:S,children:w?"저장 중...":"저장하기"})})]})};u.__docgenInfo={description:"",methods:[],displayName:"ProfileEditModal",props:{imageUrl:{required:!1,tsType:{name:"string"},description:""},nickname:{required:!0,tsType:{name:"string"},description:""},introduction:{required:!1,tsType:{name:"string"},description:""},category:{required:!1,tsType:{name:"string"},description:""},className:{required:!1,tsType:{name:"string"},description:""},onClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onSave:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: Error) => void",signature:{arguments:[{type:{name:"Error"},name:"e"}],return:{name:"void"}}},description:""}}};const z={title:"User/ProfileEditModal",component:u,tags:["autodocs"],parameters:{docs:{story:{inline:!1,iframeHeight:900}}},argTypes:{onClose:{action:"closed"},onSave:{action:"saved"}}},m={render:n=>{const[s,a]=i.useState(!0);return e.jsxs(e.Fragment,{children:[s&&e.jsx(u,{...n,imageUrl:"https://i.namu.wiki/i/bWtUr_r8eY7ikAhSgpZY0kga1QCDgZIsQI9P3UDmIDKqBJ67zQGZg95H2Svkph_k6PkQ2w_HRXj55lF9BSZD07VqH2PUdFLKWDm880fd0dIgk9nsC3vamlu0iPsjnPe4EOt6cGF7u0wWKfyYWjsaRHQRjBwFu5wmUD1RZtcxQyE.webp",nickname:"홍길동",introduction:"안녕하세요. 저는 테스트 사용자입니다.",category:"전자제품/가전제품",onClose:()=>{console.log("모달 닫기"),a(!1)},onSave:()=>{console.log("저장 클릭")}}),!s&&e.jsx("button",{onClick:()=>a(!0),className:"mt-5 rounded bg-blue-500 px-4 py-2 text-white",children:"모달 열기"})]})}};m.parameters={...m.parameters,docs:{...m.parameters?.docs,source:{originalSource:`{
  render: args => {
    const [open, setOpen] = useState(true);
    return <>
        {open && <ProfileEditModal {...args} imageUrl="https://i.namu.wiki/i/bWtUr_r8eY7ikAhSgpZY0kga1QCDgZIsQI9P3UDmIDKqBJ67zQGZg95H2Svkph_k6PkQ2w_HRXj55lF9BSZD07VqH2PUdFLKWDm880fd0dIgk9nsC3vamlu0iPsjnPe4EOt6cGF7u0wWKfyYWjsaRHQRjBwFu5wmUD1RZtcxQyE.webp" nickname="홍길동" introduction="안녕하세요. 저는 테스트 사용자입니다." category="전자제품/가전제품" onClose={() => {
        console.log("모달 닫기");
        setOpen(false);
      }} onSave={() => {
        console.log("저장 클릭");
      }} />}
        {!open && <button onClick={() => setOpen(true)} className="mt-5 rounded bg-blue-500 px-4 py-2 text-white">
            모달 열기
          </button>}
      </>;
  }
}`,...m.parameters?.docs?.source}}};const V=["Main"];export{m as Main,V as __namedExportsOrder,z as default};
