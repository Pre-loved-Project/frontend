import{R as b}from"./iframe-bTSlP73Y.js";const L=t=>{let e;const n=new Set,o=(i,v)=>{const g=typeof i=="function"?i(e):i;if(!Object.is(g,e)){const h=e;e=v??(typeof g!="object"||g===null)?g:Object.assign({},e,g),n.forEach(m=>m(e,h))}},a=()=>e,u={setState:o,getState:a,getInitialState:()=>d,subscribe:i=>(n.add(i),()=>n.delete(i))},d=e=t(o,a,u);return u},O=(t=>t?L(t):L),R=t=>t;function j(t,e=R){const n=b.useSyncExternalStore(t.subscribe,b.useCallback(()=>e(t.getState()),[t,e]),b.useCallback(()=>e(t.getInitialState()),[t,e]));return b.useDebugValue(n),n}const _=t=>{const e=O(t),n=o=>j(e,o);return Object.assign(n,e),n},T=(t=>t?_(t):_);function w(t,e){let n;try{n=t()}catch{return}return{getItem:a=>{var s;const f=d=>d===null?null:JSON.parse(d,void 0),u=(s=n.getItem(a))!=null?s:null;return u instanceof Promise?u.then(f):f(u)},setItem:(a,s)=>n.setItem(a,JSON.stringify(s,void 0)),removeItem:a=>n.removeItem(a)}}const p=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(o){return p(o)(n)},catch(o){return this}}}catch(n){return{then(o){return this},catch(o){return p(o)(n)}}}},E=(t,e)=>(n,o,a)=>{let s={storage:w(()=>localStorage),partialize:r=>r,version:0,merge:(r,S)=>({...S,...r}),...e},f=!1;const u=new Set,d=new Set;let i=s.storage;if(!i)return t((...r)=>{console.warn(`[zustand persist middleware] Unable to update item '${s.name}', the given storage is currently unavailable.`),n(...r)},o,a);const v=()=>{const r=s.partialize({...o()});return i.setItem(s.name,{state:r,version:s.version})},g=a.setState;a.setState=(r,S)=>(g(r,S),v());const h=t((...r)=>(n(...r),v()),o,a);a.getInitialState=()=>h;let m;const k=()=>{var r,S;if(!i)return;f=!1,u.forEach(c=>{var l;return c((l=o())!=null?l:h)});const y=((S=s.onRehydrateStorage)==null?void 0:S.call(s,(r=o())!=null?r:h))||void 0;return p(i.getItem.bind(i))(s.name).then(c=>{if(c)if(typeof c.version=="number"&&c.version!==s.version){if(s.migrate){const l=s.migrate(c.state,c.version);return l instanceof Promise?l.then(I=>[!0,I]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,c.state];return[!1,void 0]}).then(c=>{var l;const[I,H]=c;if(m=s.merge(H,(l=o())!=null?l:h),n(m,!0),I)return v()}).then(()=>{y?.(m,void 0),m=o(),f=!0,d.forEach(c=>c(m))}).catch(c=>{y?.(void 0,c)})};return a.persist={setOptions:r=>{s={...s,...r},r.storage&&(i=r.storage)},clearStorage:()=>{i?.removeItem(s.name)},getOptions:()=>s,rehydrate:()=>k(),hasHydrated:()=>f,onHydrate:r=>(u.add(r),()=>{u.delete(r)}),onFinishHydration:r=>(d.add(r),()=>{d.delete(r)})},s.skipHydration||k(),m||h},x=E,F=T()(x(t=>({accessToken:null,isLogined:!1,setAccessToken:e=>t({accessToken:e}),setIsLogined:e=>t({isLogined:e}),logout:()=>t({accessToken:null,isLogined:!1})}),{name:"auth-storage",partialize:t=>({isLogined:t.isLogined})}));export{T as c,F as u};
