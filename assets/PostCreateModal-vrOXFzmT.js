import{j as t}from"./jsx-runtime-BswGAHwJ.js";import{r as a}from"./iframe-Bjgk5DWC.js";import{c as d}from"./cn-DWDuF9m2.js";import{T as j}from"./TextField-B5_xj_wa.js";import{T as P}from"./TextBox-BOs7zwsB.js";import{D as _}from"./DropDown-DsnKr6n9.js";import{B as q}from"./Button-DXNA-56d.js";import{n as O}from"./image-DJVgYtnN.js";import{L as U,a as B}from"./fetcher-CZp6-9RZ.js";import{u as F}from"./uploadImage-DY3jjQGe.js";const A=({className:w,onClose:N,onCreate:b,onError:u})=>{const[m,x]=a.useState([]),[g,f]=a.useState(null),[n,C]=a.useState(""),[l,S]=a.useState(""),[i,T]=a.useState(""),[p,k]=a.useState(""),[h,v]=a.useState(!1),y=a.useRef(null),I=["전자제품/가전제품","식료품","의류/패션","스포츠/레저","뷰티/화장품","게임","도서/음반/문구","티켓/쿠폰","리빙/가구/생활","반려동물/취미"].map(e=>({label:e,value:e})),L=e=>{const s=e.currentTarget.files;if(!s||s.length==0)return;const c=Array.from(s);x(o=>[...o,...c]),f(null),e.target.value=""},R=e=>{x(s=>s.filter((c,o)=>o!==e))},D=async()=>{try{if(!n||!l||!i)return;if(m.length===0){f("이미지가 추가되지 않았습니다. 최소 1개의 이미지를 추가해주세요.");return}v(!0);const e=[];for(const o of m){const E=await F(o);e.push(E)}const c=await B("/api/postings",{method:"POST",body:JSON.stringify({title:n,price:l,content:p,category:i,images:e})});console.log("게시글 생성 성공! : ",c),b?.()}catch(e){console.error("게시글 생성 실패 : ",e),e instanceof Error&&u?.(e.message),u?.(String(e))}finally{v(!1)}},r="w-[290px] md:w-[510px] xl:w-[540px]";return t.jsx("div",{className:d("fixed inset-0 z-50 flex items-center justify-center","overflow-auto p-4",w),children:t.jsxs("div",{className:"bg-black-900 relative flex w-[335px] max-w-[620px] flex-col gap-7 rounded-lg p-6 md:w-[590px] md:p-10 xl:w-[620px] xl:p-10",children:[t.jsx("button",{type:"button",className:"absolute top-4 right-4",onClick:N,children:t.jsx("img",{src:"/icons/delete.svg",alt:"닫기",className:"h-6 w-6 text-gray-600 hover:cursor-pointer"})}),t.jsx("h2",{className:"text-lg font-semibold text-white",children:"게시물 추가"}),t.jsxs("div",{className:"scrollbar-hide flex items-center gap-4 overflow-x-auto",children:[t.jsx("label",{className:"bg-black-800 flex h-[50px] w-[50px] shrink-0 cursor-pointer items-center justify-center overflow-hidden rounded-lg md:h-[70px] md:w-[70px]",onClick:()=>y.current?.click(),children:t.jsx("img",{src:"/icons/image-select.svg",alt:"이미지 선택",className:"h-8 w-8"})}),t.jsx("input",{ref:y,type:"file",accept:"image/*",multiple:!0,onChange:L,className:"hidden"}),t.jsx("div",{className:"scrollbar-hide flex gap-3 overflow-x-auto py-1",children:m.map((e,s)=>t.jsxs("div",{className:"relative h-[70px] w-[70px] shrink-0 md:h-[100px] md:w-[100px] xl:h-[100px] xl:w-[100px]",children:[t.jsx(O,{src:URL.createObjectURL(e),alt:`preview-${s}`,fill:!0,className:"rounded-lg object-cover"}),t.jsx("button",{type:"button",className:"absolute top-0.5 right-0.5 rounded-full bg-black/50 p-1",onClick:()=>R(s),children:t.jsx("img",{src:"/icons/delete.svg",alt:"삭제",className:"h-2.5 w-2.5"})})]},s))})]}),g&&t.jsx("span",{className:d("text-[12px] md:text-[12px] xl:text-[14px]","text-red"),children:g}),t.jsx(j,{placeholder:"제목을 입력해주세요",value:n,onChange:e=>C(e.target.value),className:r}),t.jsx(j,{placeholder:"가격을 입력해주세요",type:"number",value:l,onChange:e=>{const s=Number(e.target.value);S(Number.isNaN(s)?"":s)},className:r}),t.jsx(_,{placeholder:"카테고리",value:i,onChange:e=>T(e),options:I,className:r}),t.jsx(P,{value:p,placeholder:"상품 설명을 입력하세요...",onChange:e=>k(e.target.value),className:r}),t.jsx(q,{variant:"primary",disabled:h||!n||!l||!i||!p,onClick:D,className:d("mt-4",r),children:h?t.jsxs("span",{className:"flex items-center gap-2",children:["추가 중 ",t.jsx(U,{})]}):"추가하기"})]})})};A.__docgenInfo={description:"",methods:[],displayName:"PostCreateModal",props:{className:{required:!1,tsType:{name:"string"},description:""},onClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onCreate:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"(message: string) => void",signature:{arguments:[{type:{name:"string"},name:"message"}],return:{name:"void"}}},description:""}}};export{A as P};
