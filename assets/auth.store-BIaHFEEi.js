import{c as b}from"./fetcher-CMxM3AuK.js";function k(a,l){let r;try{r=a()}catch{return}return{getItem:s=>{var t;const d=m=>m===null?null:JSON.parse(m,void 0),c=(t=r.getItem(s))!=null?t:null;return c instanceof Promise?c.then(d):d(c)},setItem:(s,t)=>r.setItem(s,JSON.stringify(t,void 0)),removeItem:s=>r.removeItem(s)}}const S=a=>l=>{try{const r=a(l);return r instanceof Promise?r:{then(n){return S(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return S(n)(r)}}}},H=(a,l)=>(r,n,s)=>{let t={storage:k(()=>localStorage),partialize:e=>e,version:0,merge:(e,h)=>({...h,...e}),...l},d=!1;const c=new Set,m=new Set;let u=t.storage;if(!u)return a((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${t.name}', the given storage is currently unavailable.`),r(...e)},n,s);const p=()=>{const e=t.partialize({...n()});return u.setItem(t.name,{state:e,version:t.version})},L=s.setState;s.setState=(e,h)=>(L(e,h),p());const g=a((...e)=>(r(...e),p()),n,s);s.getInitialState=()=>g;let f;const I=()=>{var e,h;if(!u)return;d=!1,c.forEach(o=>{var i;return o((i=n())!=null?i:g)});const v=((h=t.onRehydrateStorage)==null?void 0:h.call(t,(e=n())!=null?e:g))||void 0;return S(u.getItem.bind(u))(t.name).then(o=>{if(o)if(typeof o.version=="number"&&o.version!==t.version){if(t.migrate){const i=t.migrate(o.state,o.version);return i instanceof Promise?i.then(y=>[!0,y]):[!0,i]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,o.state];return[!1,void 0]}).then(o=>{var i;const[y,_]=o;if(f=t.merge(_,(i=n())!=null?i:g),r(f,!0),y)return p()}).then(()=>{v?.(f,void 0),f=n(),d=!0,m.forEach(o=>o(f))}).catch(o=>{v?.(void 0,o)})};return s.persist={setOptions:e=>{t={...t,...e},e.storage&&(u=e.storage)},clearStorage:()=>{u?.removeItem(t.name)},getOptions:()=>t,rehydrate:()=>I(),hasHydrated:()=>d,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(m.add(e),()=>{m.delete(e)})},t.skipHydration||I(),f||g},T=H,w=b()(T(a=>({accessToken:null,isLogined:!1,setAccessToken:l=>a({accessToken:l}),setIsLogined:l=>a({isLogined:l}),logout:()=>a({accessToken:null,isLogined:!1})}),{name:"auth-storage",partialize:a=>({isLogined:a.isLogined})}));export{w as u};
