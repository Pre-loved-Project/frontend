import{j as s}from"./jsx-runtime-C4pBERHz.js";import{r as a}from"./iframe-DDDrHg8_.js";import{c as h}from"./cn-DWDuF9m2.js";import{T as v}from"./TextField-DGWRlQmA.js";import{T as D}from"./TextBox-CKXZuVps.js";import{D as P}from"./DropDown-ClXttGL4.js";import{B as _}from"./Button-ZwxEQuRC.js";import{n as q}from"./image-BaBP7Owo.js";import{L as O,a as U}from"./fetcher-C0pZbtvP.js";import{u as B}from"./uploadImage-DY3jjQGe.js";const E=({className:y,onClose:w,onCreate:b,onError:p})=>{const[d,u]=a.useState([]),[n,j]=a.useState(""),[l,N]=a.useState(""),[i,C]=a.useState(""),[m,S]=a.useState(""),[g,x]=a.useState(!1),f=a.useRef(null),T=["전자제품/가전제품","식료품","의류/패션","스포츠/레저","뷰티/화장품","게임","도서/음반/문구","티켓/쿠폰","리빙/가구/생활","반려동물/취미"].map(e=>({label:e,value:e})),k=e=>{const t=e.currentTarget.files;if(!t||t.length==0)return;const c=Array.from(t);u(o=>[...o,...c]),e.target.value=""},I=e=>{u(t=>t.filter((c,o)=>o!==e))},L=async()=>{try{if(!n||!l||!i)return;x(!0);const e=[];for(const o of d){const R=await B(o);e.push(R)}const c=await U("/api/postings",{method:"POST",body:JSON.stringify({title:n,price:l,content:m,category:i,images:e})});console.log("게시글 생성 성공! : ",c),b?.()}catch(e){console.error("게시글 생성 실패 : ",e),e instanceof Error&&p?.(e.message),p?.(String(e))}finally{x(!1)}},r="w-[290px] md:w-[510px] xl:w-[540px]";return s.jsx("div",{className:h("fixed inset-0 z-50 flex items-center justify-center","overflow-auto p-4",y),children:s.jsxs("div",{className:"bg-black-900 relative flex w-[335px] max-w-[620px] flex-col gap-7 rounded-lg p-6 md:w-[590px] md:p-10 xl:w-[620px] xl:p-10",children:[s.jsx("button",{type:"button",className:"absolute top-4 right-4",onClick:w,children:s.jsx("img",{src:"/icons/delete.svg",alt:"닫기",className:"h-6 w-6 text-gray-600 hover:cursor-pointer"})}),s.jsx("h2",{className:"text-lg font-semibold text-white",children:"게시물 추가"}),s.jsxs("div",{className:"scrollbar-hide flex items-center gap-4 overflow-x-auto",children:[s.jsx("label",{className:"bg-black-800 flex h-[50px] w-[50px] shrink-0 cursor-pointer items-center justify-center overflow-hidden rounded-lg md:h-[70px] md:w-[70px]",onClick:()=>f.current?.click(),children:s.jsx("img",{src:"/icons/image-select.svg",alt:"이미지 선택",className:"h-8 w-8"})}),s.jsx("input",{ref:f,type:"file",accept:"image/*",multiple:!0,onChange:k,className:"hidden"}),s.jsx("div",{className:"scrollbar-hide flex gap-3 overflow-x-auto py-1",children:d.map((e,t)=>s.jsxs("div",{className:"relative h-[70px] w-[70px] shrink-0 md:h-[100px] md:w-[100px] xl:h-[100px] xl:w-[100px]",children:[s.jsx(q,{src:URL.createObjectURL(e),alt:`preview-${t}`,fill:!0,className:"rounded-lg object-cover"}),s.jsx("button",{type:"button",className:"absolute top-0.5 right-0.5 rounded-full bg-black/50 p-1",onClick:()=>I(t),children:s.jsx("img",{src:"/icons/delete.svg",alt:"삭제",className:"h-2.5 w-2.5"})})]},t))})]}),s.jsx(v,{placeholder:"제목을 입력해주세요",value:n,onChange:e=>j(e.target.value),className:r}),s.jsx(v,{placeholder:"가격을 입력해주세요",type:"number",value:l,onChange:e=>{const t=Number(e.target.value);N(Number.isNaN(t)?"":t)},className:r}),s.jsx(P,{placeholder:"카테고리",value:i,onChange:e=>C(e),options:T,className:r}),s.jsx(D,{value:m,placeholder:"상품 설명을 입력하세요...",onChange:e=>S(e.target.value),className:r}),s.jsx(_,{variant:"primary",disabled:g||!n||!l||!i||!m,onClick:L,className:h("mt-4",r),children:g?s.jsxs("span",{className:"flex items-center gap-2",children:["추가 중 ",s.jsx(O,{})]}):"추가하기"})]})})};E.__docgenInfo={description:"",methods:[],displayName:"PostCreateModal",props:{className:{required:!1,tsType:{name:"string"},description:""},onClose:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onCreate:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"(message: string) => void",signature:{arguments:[{type:{name:"string"},name:"message"}],return:{name:"void"}}},description:""}}};export{E as P};
